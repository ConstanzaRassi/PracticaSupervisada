<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Sharp" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">

    <link rel="stylesheet" href="adminStyle.css">
    <title>Dashboard</title>
    <style>
        main .grafico>div {
            background: var(--color-white);
            padding: var(--card-padding);
            border-radius: var(--card-border-radius);
            margin-top: 1.rem;
            box-shadow: var(--box-shadow);
            transition: all 300ms ease;
            height: 342px;
        }

        main .grafico>div:hover {
            box-shadow: none;
        }
    </style>
</head>

<body>
    <div class="container">
        <!--ASIDE SECTION-->
        <aside>
            <div class="top">
                <div class="logo">
                    <img src="/img/logo1.png" alt="">
                    <h2>Vita<span>MOVE</span></h2>
                </div>
                <div class="close" id="close-btn">
                    <span class="material-icons-sharp">close</span>
                </div>
            </div>
            <div class="sidebar">
                <a href="dashboard.html" class="active">
                    <span class="material-icons-sharp">dashboard</span>
                    <h3>Dashboard</h3>
                </a>
                <a href="listAlumnos.html">
                    <span class="material-icons-sharp">account_circle</span>
                    <h3>Alumnos</h3>
                </a>
                <a href="listProfesores.html">
                    <span class="material-icons-sharp">badge</span>
                    <h3>Profesores</h3>
                </a>
                <a href="listClases.html">
                    <span class="material-icons-sharp">fitness_center</span>
                    <h3>Clases</h3>
                </a>
                <a href="listFacturas.html">
                    <span class="material-icons-sharp">request_quote</span>
                    <h3>Facturas</h3>
                </a>
                <a href="listSucursales.html">
                    <span class="material-icons-sharp">location_on</span>
                    <h3>Sucursales</h3>
                </a>
                <a href="/login.html">
                    <span class="material-icons-sharp">logout</span>
                    <h3>Logout</h3>
                </a>
            </div>
        </aside>

        <!--MAIN SECTION-->
        <main>
            <h1>DASHBOARD</h1>
            <div class="contanier" style="display: flex;">
                <div class="date">
                    <h5>Desde:</h5>
                    <input type="date" id="fechaDesde">
                </div>
                <div class="date">
                    <h5>Hasta:</h5>
                    <input type="date" id="fechaHasta">
                </div>
                <div style="margin-top: 20px;">
                    <button type="button" id="btnCargar"
                        style="font-size:30px;background-color: transparent; color: #650b0b;"><i
                            class="bi bi-check-circle-fill"></i></i></button>
                </div>
            </div>


            <div class="insights">

                <div class="sales">
                    <span class="material-icons-sharp">analytics</span>
                    <div class="middle">
                        <div class="left">
                            <h3>Promedio de alumnos por clase</h3>
                        </div>
                        <br>
                        <div class="progress">
                            <h1 id="txtPromedioAlumnos" style="margin-top: 20px;">9</h1>
                        </div>
                    </div>
                </div>

                <div class="income">
                    <span class="material-icons-sharp">bar_chart</span>
                    <div class="middle">
                        <div class="left">
                            <h3>Total facturado</h3>
                        </div>
                        <br>
                        <div class="progress">

                            <h1 id="txtTotalFacturado" style="margin-top: 20px;">$89020</h1>

                        </div>
                    </div>
                </div>
                <div class="expenses">
                    <span class="material-icons-sharp">analytics</span>
                    <div class="middle">
                        <div class="left">
                            <h3>Clases dictadas</h3>
                        </div>
                        <br>
                        <div class="progress">

                            <h1 id="txtClasesDictadas" style="margin-top: 20px;">67</h1>

                        </div>
                    </div>
                </div>
            </div>
            <br>
            <br>


            <div class="grafico">
                <div>
                    <canvas id="myChart" width="400" height="170"></canvas>
                </div>
            </div>


        </main>
        <div class="right">
            <div class="top">
                <button id="menu-btn">
                    <span class="material-icons-sharp">menu</span>
                </button>
                <div class="theme-toggler">
                    <span class="material-icons-sharp active">light_mode</span>
                    <span class="material-icons-sharp">dark_mode</span>
                </div>
                <div class="profile">
                    <div class="info">
                        <p>Hey <b>ADMIN</b></p>
                    </div>
                    <div class="profile-photo">
                        <img src="/img/admin.jpg" alt="">
                    </div>
                </div>
            </div>

            <div class="recent-updates">
                <h2>NOVEDADES</h2>
                <div class="updates">
                    <div class="update">
                        <div class="profile-photo">
                            <img src="/img/person3.jpg" alt="">
                        </div>
                        <div class="message">
                            <p><b>Paula Gonzalez</b> se dio de baja</p>
                            <small class="text-muted">Hace 5 minutos</small>
                        </div>
                    </div>
                    <div class="update">
                        <div class="profile-photo">
                            <img src="/img/person2.jpg" alt="">
                        </div>
                        <div class="message">
                            <p><b>Joaquin Martinez</b> pagó plan ORO</p>
                            <small class="text-muted">Hace 12 minutos</small>
                        </div>
                    </div>
                    <div class="update">
                        <div class="profile-photo">
                            <img src="/img/person1.jpg" alt="">
                        </div>
                        <div class="message">
                            <p><b>Martina Velasco</b> se incorporó al gimnasio</p>
                            <small class="text-muted">Hace 24 minutos</small>
                        </div>
                    </div>
                </div>
            </div>


            <div class="sales-analytics">
                <h2>REPORTES</h2>
                <div class="item customers">
                    <div class="icon">
                        <span class="material-icons-sharp">calendar_month</span>
                    </div>
                    <div class="right">
                        <div class="info">
                            <h3 style="font-size: 16px;">Día más concurrido</h3>
                            <small class="text-muted"></small>
                        </div>
                        <h2 id="txtDiaConcurrencia" style="font-size: 15px; color: darkcyan; text-align: center;">Jueves
                        </h2>
                    </div>
                </div>
                <div class="item customers">
                    <div class="icon">
                        <span class="material-icons-sharp">person</span>
                    </div>
                    <div class="right">
                        <div class="info">
                            <h3 style="font-size: 16px;">Alumnos activos</h3>
                            <small class="text-muted"></small>
                        </div>

                        <h2 id="txtAlumnosActivos"
                            style="font-size: 15px; color: rgb(0, 139, 139); text-align: center;">26</h2>
                    </div>
                </div>
                <div class="item customers">
                    <div class="icon">
                        <span class="material-icons-sharp">pin_drop</span>
                    </div>
                    <div class="right">
                        <div class="info">
                            <h3 style="font-size: 16px;">Sucursal más concurrida</h3>
                            <small class="text-muted"></small>
                        </div>

                        <h2 id="txtSucursalConcurrencia" style="font-size: 15px; color: darkcyan; text-align: center;">
                            Nueva Córdoba</h2>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="/adminView/admin.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/excanvas/r3/excanvas.js" type="text/javascript"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script>
        $(document).ready(function () {
            const ctx = document.getElementById('myChart').getContext('2d');
            console.log(ctx);
            const myChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Funcional', 'Musculación', 'Crossfit', 'Stretching', 'Cardio'],
                    datasets: [{
                        label: 'Alumnos por disciplina',
                        data: [40, 24, 35, 13, 29],
                        backgroundColor: [
                            'rgb(0, 139, 139)'

                        ]
                    }]
                },
                options: {
                    scales: {
                        x: {
                            grid: {
                                offset: false
                            }
                        },
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });

            console.log(data);

        })
    </script>
    <script>
        //Reportes con parametros fechas desde y hasta
        $("#btnCargar").click(function () {
            let desde = $("#fechaDesde").val();
            let hasta = $("#fechaHasta").val();
            if (desde === "" || hasta === "") {
                console.log("toma los datos null");
            } else {
                cargarDatos(desde, hasta);
            }
        });

        function cargarDatos(desde, hasta) {
            console.log(desde);
            console.log(hasta);

            $.ajax({
                url: "https://localhost:5001/Reporte/ObtenerPromedioAlumnos?desde=" + desde + "&hasta=" + hasta,
                type: "GET",
                dataType: 'JSON',
                success: function (result) {
                    if (result.ok) {
                        $('#txtPromedioAlumnos').html(Math.round(result.return));
                    } else {
                        console.log("encontro algun error");
                    }
                },
                error: function (error) {
                    console.log("problemas de servidor");
                },
            })
            $.ajax({
                url: "https://localhost:5001/Reporte/ObtenerTotalFacturado?desde=" + desde + "&hasta=" + hasta,
                type: "GET",
                dataType: 'JSON',
                success: function (result) {
                    if (result.ok) {
                        $('#txtTotalFacturado').html("$" + result.return);
                    } else {
                        console.log("encontro algun error");
                    }
                },
                error: function (error) {
                    console.log("problemas de servidor");
                },
            })
            $.ajax({
                url: "https://localhost:5001/Reporte/ObtenerClasesDictadas?desde=" + desde + "&hasta=" + hasta,
                type: "GET",
                dataType: 'JSON',
                success: function (result) {
                    if (result.ok) {
                        $('#txtClasesDictadas').html(result.return);
                    } else {
                        console.log("encontro algun error");
                    }
                },
                error: function (error) {
                    console.log("problemas de servidor");
                },
            })


        }

        //Reportes sin parametros
        $(document).ready(function () {
            //inicializo estos para que muestre cuando abre el dashboard
            // $.ajax({
            //     url: "https://localhost:5001/Reporte/InicializaPromedio",
            //     type: "GET",
            //     success: function (result) {
            //         if (result.ok) {
            //             $('#txtPromedioAlumnos').html(result.return);
            //         } else {
            //             swal(result.error);
            //         }
            //     },
            //     error: function (error) {
            //         console.log(); (error);
            //     },
            // });
            $.ajax({
                url: "https://localhost:5001/Reporte/InicializaFacturacion",
                type: "GET",
                success: function (result) {
                    if (result.ok) {
                        $('#txtTotalFacturado').html("$" + result.return);
                    } else {
                        swal(result.error);
                    }
                },
                error: function (error) {
                },
            });

            // $.ajax({
            //     url: "https://localhost:5001/Reporte//InicializaClasesDictadas",
            //     type: "GET",
            //     success: function (result) {
            //         if (result.ok) {
            //             $('#txtClasesDictadas').html(result.return);
            //         } else {
            //             swal(result.error);
            //         }
            //     },
            //     error: function (error) {
            //     },
            // });

            //abajo a la derecha
            // $.ajax({
            //     url: "https://localhost:5001/Reporte/ObtenerDiaMayorConcurrencia",
            //     type: "GET",
            //     success: function (result) {
            //         if (result.ok) {
            //             $('#txtDiaConcurrencia').html(result.return);
            //         } else {
            //             swal(result.error);
            //         }
            //     },
            //     error: function (error) {
            //         console.log(); (error);
            //     },
            // });
            $.ajax({
                url: "https://localhost:5001/Reporte/ObtenerAlumnosActivos",
                type: "GET",
                success: function (result) {
                    if (result.ok) {
                        $('#txtAlumnosActivos').html(result.return);
                    } else {
                        swal(result.error);
                    }
                },
                error: function (error) {
                },
            });

            $.ajax({
                url: "https://localhost:5001/Reporte//ObtenerSucursalMayorConcurrencia",
                type: "GET",
                success: function (result) {
                    if (result.ok) {
                        $('#txtSucursalConcurrencia').html(result.return);
                    } else {
                        swal(result.error);
                    }
                },
                error: function (error) {
                },
            });


        })


    </script>




</body>

</html>